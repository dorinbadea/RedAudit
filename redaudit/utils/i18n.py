#!/usr/bin/env python3
"""
RedAudit - Internationalization (i18n)
Copyright (C) 2026  Dorin Badea
GPLv3 License

Translation strings for English and Spanish.
"""

TRANSLATIONS = {
    "en": {
        "interrupted": "\n⚠️  Interruption received. Saving current state...",
        "heartbeat_info": "⏱  Activity Monitor: {} ({}s elapsed)",
        "heartbeat_warn": "⏱  Activity Monitor: {} - No output for {}s (nmap might be busy)",
        "heartbeat_fail": (
            "⏱  Activity Monitor: {} - Long silence (> {}s). "
            "Nmap is still running; this is normal on slow or filtered hosts."
        ),
        "deep_scan_skip": "✅ Info sufficient (MAC/OS found), skipping phase 2.",
        "verifying_env": "Verifying environment integrity...",
        "detected": "✓ {} detected",
        "nmap_avail": "✓ python-nmap available",
        "nmap_missing": "python-nmap library not found. Please install the system package 'python3-nmap' via apt.",
        "missing_crit": "Error: missing critical dependencies: {}",
        "missing_opt": "Warning: missing optional tools: {} (reduced web/traffic features)",
        "crypto_missing": "cryptography library not available. Report encryption disabled.",
        "avail_at": "✓ {} available at {}",
        "not_found": "{} not found (automatic usage skipped)",
        "ask_yes_no_opts": " (Y/n)",
        "ask_yes_no_opts_neg": " (y/N)",
        "ask_num_limit": "Host limit for deep scan (or 'all'):",
        "val_out_of_range": "Value out of range ({}-{})",
        "select_opt": "Select an option",
        "invalid_cidr": "Invalid CIDR",
        "analyzing_nets": "Analyzing local interfaces and networks...",
        "netifaces_missing": "netifaces not available, using fallback method",
        "no_nets_auto": "No networks detected automatically",
        "select_net": "Select network:",
        "manual_entry": "Enter manual",
        "scan_all": "Scan ALL",
        "scan_config": "SCAN CONFIGURATION",
        "scan_mode": "Scan Mode:",
        "mode_fast": "FAST (Discovery only)",
        "mode_normal": "NORMAL (Discovery + Top Ports)",
        "mode_full": "FULL (Full Ports + Scripts + Vulns + Deep Identity Scan)",
        "threads": "Concurrent threads:",
        "vuln_scan_q": "Run web vulnerability analysis?",
        "gen_txt": "Generate additional TXT report?",
        "output_dir": "Output directory:",
        "start_audit": "Start audit?",
        "scan_start": "Scanning {} hosts...",
        "scanning_host": "Scanning host {}... (Mode: {})",
        "hosts_active": "Active hosts in {}: {}",
        "scan_error": "Scan failed: {}",
        "progress": "Progress: {}/{} hosts",
        "vuln_analysis": "Analyzing vulnerabilities on {} web hosts...",
        "vulns_found": "⚠️  Vulnerabilities found on {}",
        "no_hosts": "No hosts found.",
        "exec_params": "EXECUTION PARAMETERS",
        "targets": "Targets",
        "mode": "Mode",
        "output": "Output",
        "final_summary": "FINAL SUMMARY",
        "nets": "  Networks:    {}",
        "hosts_up": "  Hosts up:    {}",
        "hosts_full": "  Hosts full:  {}",
        "vulns_web": "  Web vulns:   {}",
        "duration": "  Duration:    {}",
        "reports_gen": "\n✓ Reports generated in {}",
        "legal_warn": "\nLEGAL WARNING: Only for use on authorized networks.",
        "legal_ask": "Do you confirm you have authorization to scan these networks?",
        "json_report": "JSON Report: {}",
        "txt_report": "TXT Report: {}",
        "save_err": "Error saving report: {}",
        "root_req": "Error: root privileges (sudo) required.",
        "config_cancel": "Configuration cancelled.",
        "banner_subtitle": "   INTERACTIVE NETWORK AUDIT     ::  KALI LINUX",
        "selection_target": "TARGET SELECTION",
        "interface_detected": "✓ Interfaces detected:",
        "encrypt_reports": "Encrypt reports with password?",
        "encryption_password": "Report encryption password",
        "encryption_enabled": "✓ Encryption enabled",
        "cryptography_required": "Error: Encryption requires python3-cryptography. Install with: sudo apt install python3-cryptography",
        "rate_limiting": "Enable rate limiting (slower but stealthier)?",
        "rate_delay": "Delay between hosts (seconds):",
        "ports_truncated": "⚠️  {}: {} ports found, showing top 50",
        "deep_identity_start": "Deep identity scan for {} (strategy: {})",
        "deep_identity_cmd": "[deep] {} → {} (~{}s estimated)",
        "deep_identity_done": "Deep identity scan finished for {} in {:.1f}s",
        "nmap_cmd": "[nmap] {} → {}",
    },
    "es": {
        "interrupted": "\n⚠️  Interrupción recibida. Guardando estado actual...",
        "heartbeat_info": "⏱  Monitor de Actividad: {} ({}s transcurridos)",
        "heartbeat_warn": "⏱  Monitor de Actividad: {} - Sin salida hace {}s (nmap puede estar ocupado)",
        "heartbeat_fail": (
            "⏱  Monitor de Actividad: {} - Silencio prolongado (> {}s). "
            "Nmap sigue ejecutándose; esto es normal en hosts lentos o filtrados."
        ),
        "deep_scan_skip": "✅ Info suficiente (MAC/OS detectado), saltando fase 2.",
        "verifying_env": "Verificando integridad del entorno...",
        "detected": "✓ {} detectado",
        "nmap_avail": "✓ python-nmap disponible",
        "nmap_missing": "Librería python-nmap no encontrada. Instala el paquete de sistema 'python3-nmap' vía apt.",
        "missing_crit": "Error: faltan dependencias críticas: {}",
        "missing_opt": "Aviso: faltan herramientas opcionales: {} (menos funciones web/tráfico)",
        "crypto_missing": "Librería cryptography no disponible. El cifrado de reportes queda deshabilitado.",
        "avail_at": "✓ {} disponible en {}",
        "not_found": "{} no encontrado (se omitirá su uso automático)",
        "ask_yes_no_opts": " (S/n)",
        "ask_yes_no_opts_neg": " (s/N)",
        "ask_num_limit": "Límite de hosts a escanear en profundidad (o 'todos'):",
        "val_out_of_range": "Valor fuera de rango ({}-{})",
        "select_opt": "Selecciona una opción",
        "invalid_cidr": "CIDR inválido",
        "analyzing_nets": "Analizando interfaces y redes locales...",
        "netifaces_missing": "netifaces no disponible, usando método alternativo",
        "no_nets_auto": "No se detectaron redes automáticamente",
        "select_net": "Selecciona red:",
        "manual_entry": "Introducir manual",
        "scan_all": "Escanear TODAS",
        "scan_config": "CONFIGURACIÓN DE ESCANEO",
        "scan_mode": "Modo de escaneo:",
        "mode_fast": "RÁPIDO (solo discovery)",
        "mode_normal": "NORMAL (Discovery + Puertos principales)",
        "mode_full": "COMPLETO (Puertos + Scripts + Vulns + Deep Identity Scan)",
        "threads": "Hilos concurrentes:",
        "vuln_scan_q": "¿Ejecutar análisis de vulnerabilidades web?",
        "gen_txt": "¿Generar reporte TXT adicional?",
        "output_dir": "Directorio de salida:",
        "start_audit": "¿Iniciar auditoría?",
        "scan_start": "Escaneando {} hosts...",
        "scanning_host": "Escaneando host {}... (Modo: {})",
        "hosts_active": "Hosts activos en {}: {}",
        "scan_error": "Fallo en escaneo: {}",
        "progress": "Progreso: {}/{} hosts",
        "vuln_analysis": "Analizando vulnerabilidades en {} hosts web...",
        "vulns_found": "⚠️  Vulnerabilidades registradas en {}",
        "no_hosts": "No se encontraron hosts.",
        "exec_params": "PARÁMETROS DE EJECUCIÓN",
        "targets": "Objetivos",
        "mode": "Modo",
        "output": "Salida",
        "final_summary": "RESUMEN FINAL",
        "nets": "  Redes:       {}",
        "hosts_up": "  Hosts vivos: {}",
        "hosts_full": "  Hosts full:  {}",
        "vulns_web": "  Vulns web:   {}",
        "duration": "  Duración:    {}",
        "reports_gen": "\n✓ Reportes generados en {}",
        "legal_warn": "\nADVERTENCIA LEGAL: Solo para uso en redes autorizadas.",
        "legal_ask": "¿Confirmas que tienes autorización para escanear estas redes?",
        "json_report": "Reporte JSON: {}",
        "txt_report": "Reporte TXT: {}",
        "save_err": "Error guardando reporte: {}",
        "root_req": "Error: se requieren privilegios de root (sudo).",
        "config_cancel": "Configuración cancelada.",
        "banner_subtitle": "   AUDITORÍA DE RED INTERACTIVA  ::  KALI LINUX",
        "selection_target": "SELECCIÓN DE OBJETIVO",
        "interface_detected": "✓ Interfaces detectadas:",
        "encrypt_reports": "¿Cifrar reportes con contraseña?",
        "encryption_password": "Contraseña para cifrar reportes",
        "encryption_enabled": "✓ Cifrado activado",
        "cryptography_required": "Error: El cifrado requiere python3-cryptography. Instala con: sudo apt install python3-cryptography",
        "rate_limiting": "¿Activar limitación de velocidad (más lento pero más sigiloso)?",
        "rate_delay": "Retardo entre hosts (segundos):",
        "ports_truncated": "⚠️  {}: {} puertos encontrados, mostrando los 50 principales",
        "deep_identity_start": "Deep identity scan para {} (estrategia: {})",
        "deep_identity_cmd": "[deep] {} → {} (~{}s estimados)",
        "deep_identity_done": "Deep identity scan finalizado para {} en {:.1f}s",
        "nmap_cmd": "[nmap] {} → {}",
    },
}


def get_text(key: str, lang: str = "en", *args) -> str:
    """
    Get translated text for a given key.

    Args:
        key: Translation key
        lang: Language code ('en' or 'es')
        *args: Format arguments

    Returns:
        Translated and formatted string
    """
    lang_dict = TRANSLATIONS.get(lang, TRANSLATIONS["en"])
    val = lang_dict.get(key, key)
    return val.format(*args) if args else val
